# 进程的描述与控制

## 前趋图与程序执行

### 前趋图

前趋图是一个 **有向无循环图** ，用于描述程序执行的先后顺序。图中的每个结点可用来表示一个进程或程序段，结点间的有向边表示俩个结点间的偏序或前趋关系。

### 程序顺序执行

- **程序的顺序执行**

  在执行时某种先后次序顺序执行，并且当前一个程序执行完后，才会运行下一个程序

- **特征**

  - **顺序性：** 程序只能顺序执行
  - **封闭性：** 程序在封闭的环境中运行，即程序运行时独占全机资源
  - **可再现性：** 只要程序执行的环境不变，当程序重复执行时，不论它停顿还是不停顿，结果都相同

### 程序并发执行

- 只要程序之间不存在前趋关系，那么程序就可以并发执行
- **特征**
  - **间断性**
  - **失去封闭性**
  - **不可再现性**

## 进程的描述

### 进程的定义

在多道程序环境下，程序的执行属于并发执行，此时就会有间断性，失去封闭性和不可再现性，所以这就决定了通常的程序是不能参加并发执行的，为了能让程序并发执行，引入了进程的概念。

#### 进程控制块

:star: 为了使参与并发执行的每个程序（含数据）都能独立运行，在操作系统中必须为之配置一个专门的**数据结构** ， 称为**进程控制块（PCB）** ，系统利用PCB描述进程的基本情况和活动过程。

- **进程实体**，它包含以下内容
  - 程序段
  - 相关数据段
  - PCB

一般情况下，把进程实体就简称为进程。

:star:**创建进程，实质上就是创建进程实体中的PCB**

:star:**撤销进程，实质上就是撤销进程实体中的PCB**

#### 进程定义

进程在不同角度有不同定义，常见的定义有如下：

- 进程是程序的一次执行
- 进程是一个程序及其数据在处理机上顺序执行时所发生的活动
- 进程是具有独立功能的程序在一个数据集合上运行的过程，它是系统进行资源分配和调度的一个独立单位

:star2:**进程是进程实体的运行过程，是系统进行资源分配和调度的一个独立单位**

### 进程的特征

- **动态性**
  - 进程的实质是进程实体的执行过程
  - 进程”*由创建而产生，由调度而执行，由撤销而消亡*“，可见进程是有一定的生命周期，而程序只是一组有序指令集合
- **并发性**
  - 多个进程实体同存于内存中，并且在一段时间内同时运行，没有建立PCB的程序是不能参与并发执行的。
- **独立性**
  - 进程实体是一个能独立运行，独立获得资源，独立接受调度的基本单位。
- **异步性**
  - 进程是按照异步方式运行的

### 进程的三种基本状态

- **就绪状态**
  - 这是指进程已处于准备好运行的状态，即进程已经分配到除CPU以外的所有资源，只要获得CPU，就可以立即执行
  - 如果系统中有许多处于就绪状态的进行，通常将它们按照一定的策略排成一个队列，称该队列为就绪队列
- **执行状态**
  - 这是指进程已经获得了CPU资源，程序正在执行
    - 单处理机：只有一个进程处于执行状态
    - 多处理机：多个进程处于执行装状态
- **阻塞状态**
  - 这是指正在执行的进程由于发生某种事件(如I/O请求，申请缓冲区失败)暂时无法继续执行的状态
  - 通常会有阻塞队列

### 三种基本状态的转换

![20200718164241.png](https://github.com/yxcoder1997/PictureBed/blob/master/img/20200718164241.png?raw=true)

### 创建状态和终止状态

为了满足PCB对数据及操作的完整性要求以及增强管理的灵活性，通常在系统中为又为进程引入了两种常见的状态：创建状态和终止状态

- **创建状态**

  - 创建进程步骤
    - 由进程申请一个空白PCB 
    - 向PCB中填写用于控制和管理进程的信息
    - 分配该进程运行时所必须的资源
    - 把该进程转入就绪状态并插入就绪队列

  如果**进程所需要的资源尚不能满足，此时的创建工作尚未完成，进程不能被调度运行**，于是把此时进程所处的状态称为创建状态。

  - **目的**：保证进程的调度必须在创建工作完成后进行，以确保对PCB操作的完整性

- **终止状态**

  - 终止进程步骤
    - 等待操作系统进行善后处理
    - 将其PCB清零
    - 将PCB空间返还系统

  当一个进程达到了自然结束点，或时出现了无法克服的错误，或被OS所终结，或被其他由终止权的进程所终结，它将进入终止状态。

  进入终止状态的进程不能再执行，但OS中依然保留一个记录（状态码和计时统计数据），供其他进程收集，收集完毕后将终止该进程。

![](https://raw.githubusercontent.com/yxcoder1997/PictureBed/master/img/20200718165331.png)